h1q1 <- read.csv("h1q1.csv")
set.seed(42)

rmse = function(actual, predicted) {
  sqrt(mean((actual - predicted) ^ 2))
}

get_complexity = function(model) {
  length(coef(model)) - 1
}

train_index = sample(1:nrow(h1q1), size=round(0.5*nrow(h1q1)))
train_data = h1q1[train_index,]
test_data = h1q1[-train_index,]

# Just a linear model
m1 <- y ~ .
m2 <- y ~ . + I(a^2) + I(b^2) + I(c^2)
m3 <- y ~ .ˆ2 + I(aˆ2) + I(bˆ2) + I(cˆ2)
m4 <- y ~ a * b * c * d + I(aˆ2) + I(bˆ2) + I(cˆ2)

fit1 = lm(m1, data=train_data)
get_rmse(fit1, data=train_data, response="y")
get_rmse(fit1, data=test_data, response="y")
get_complexity(fit1)
